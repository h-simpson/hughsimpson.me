language: node_js
node_js:
  - node

cache:
  yarn: true

sudo: required

services:
  - docker
  
branches:
  only:
  - continuous-deployment

install: yarn install

script: yarn run build

after_script: 
  - docker build --tag "$DOCKER_REPO" .
  - docker run -d -p 80:80 "$DOCKER_REPO" 
  - docker login -u "$DOCKER_USERNAME" -p "$DOCKER_PASSWORD"
  - docker push "$DOCKER_REPO"